FROM python:3.11-slim

WORKDIR /app

# Copy your autoposting script (e.g., autopost.py)
COPY autopost.py /app/autopost.py

# Install required Python packages
RUN pip install requests

# Add crontab file
COPY crontab.txt /etc/cron.d/bluesky-cron

# Give execution rights on the cron job
RUN chmod 0644 /etc/cron.d/bluesky-cron

# Apply the cron job
RUN crontab /etc/cron.d/bluesky-cron

# Create the log file to be able to run tail
RUN touch /var/log/cron.log

# Command to run cron in the foreground
CMD cron && tail -f /var/log/cron.log
